{"version":3,"sources":["store/params/params.actions.js","ProductSelectorError.js","backends/SFCC.js","backends/Hybris.js","backends/CommerceTools.js","backends/backends.js","store/backend/backend.actions.js","store/pages/pages.actions.js","store/fetching/fetching.actions.js","store/global-error/global-error.actions.js","store/items/items.actions.js","store/initialised/initialised.actions.js","store/selectedItems/selectedItems.actions.js","store/catalog/catalog.actions.js","store/sdk/sdk.actions.js","store/pages/pages.reducer.js","store/params/params.reducer.js","store/store.js","store/sdk/sdk.reducer.js","store/items/items.reducer.js","store/backend/backend.reducer.js","store/touched/touched.reducer.js","store/touched/touched.actions.js","store/fetching/fetching.reducer.js","store/searchText/searchText.reducer.js","store/searchText/searchText.actions.js","store/initialised/initialised.reducer.js","store/catalog/catalog.reducer.js","store/selectedItems/selectedItems.reducer.js","store/global-error/global-error.reducer.js","theme.js","search-box/SearchBox.js","pager/Pager.js","fade-in/FadeIn.js","product/Product.js","catalog-selector/CatalogSelector.js","pagination-summary/PaginationSummary.js","products-grid/ProductsGrid.js","form-error/FormError.js","selected-products/SelectedProducts.js","App.js","index.js"],"names":["setParams","params","type","value","ProductSelectorError","message","code","Error","codes","INVALID_FIELD","INVALID_VALUE","GET_ITEMS","GET_SELECTED_ITEMS","GET_SDK","SFCC","settings","this","state","authSecret","headers","authClientId","endpoint","sfccUrl","ids","site_id","siteId","proxyUrl","queryString","qs","stringify","arrayFormat","method","getHeaders","fetch","trimEnd","response","json","items","console","error","searchText","page","selectedCatalog","emptyResult","numPages","curPage","total","body","search_text","catalog_id","JSON","item","id","Hybris","hybrisUrl","productService","ProductService","filterIds","currency","getItem","a","catalog","getByCode","itemModel","Promise","all","map","_get","search","products","pagination","totalResults","currentPage","totalPages","pages","getProductImage","images","find","format","length","url","defaultImageUrl","html","tmp","document","createElement","innerHTML","textContent","innerText","name","stripHtml","image","getImage","CommerceTools","host","projectKey","clientId","clientSecret","apiUrl","scope","locale","sdkAuth","SdkAuth","disableRefreshToken","credentials","scopes","clientCredentialsFlow","token","token_type","access_token","PAGE_SIZE","idsStrings","join","staged","limit","where","results","parseResults","attributes","largeImage","data","masterVariant","key","offset","Math","ceil","backends","initBackend","dispatch","getState","backend","getBackend","setBackend","setPage","changePage","getItems","setFetching","setGlobalError","setValue","selectedItems","SDK","field","exportItem","component","props","get","isEmpty","trim","setItems","fetchedItems","setInitialised","addItem","removeItem","setCatalog","setSDK","initalState","catalogs","noItemsText","searchPlaceholderText","rootReducer","combineReducers","action","installation","instance","selectedParams","toLower","touched","isFetching","initialised","reject","oldIndex","newIndex","itemToMove","remainingItems","reorderedItems","slice","globalError","composeEnhancer","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunkMiddleware","theme","createMuiTheme","palette","primary","main","secondary","styles","makeStyles","root","width","marginBottom","spacing","padding","display","alignItems","input","marginLeft","flex","icon","fill","divider","height","margin","debouncedSearch","debounce","e","SearchBox","connect","setSearchText","classes","className","Paper","InputBase","placeholder","inputProps","onChange","event","isUndefined","target","Divider","orientation","Search","marginTop","Pager","allPages","range","take","takeRight","startPages","endPages","ButtonGroup","color","Button","aria-label","onClick","disabled","SkipPrevious","fontSize","ArrowLeft","variant","ArrowRight","SkipNext","FadeIn","show","children","exitOptions","div","initial","opacity","animate","exit","flexDirection","transition","border","isSelected","grey","readOnly","pointerEvents","cardWrapper","thumbnail","paddingBottom","backgroundColor","hasImage","removeBtn","Product","toggleProduct","useState","visible","setVisible","isRemovable","Boolean","form","toggle","hideProduct","useEffect","cardMedia","CardMedia","title","CardAction","IconButton","Clear","cardBody","CardActionArea","Card","raised","CardHeader","subheader","titleTypographyProps","subheaderTypographyProps","select","minWidth","CatalogSelector","changeCatalog","labelWidth","setLabelWidth","setSelectedCatalog","inputLabel","React","useRef","current","offsetWidth","FormControl","InputLabel","ref","Select","labelId","newCatalog","MenuItem","PaginationSummary","start","first","last","min","Typography","gridTemplateColumns","justifyContent","loader","ProductsGrid","loading","Grid","container","xs","position","CircularProgress","FormError","FormHelperText","minHeight","boxSizing","overflow","dragItem","fontWeight","zIndex","errorWrapper","alignSelf","textAlign","top","ProductList","isDragging","positionTransition","Loading","NoItems","Box","SelectedProducts","reorderItems","indexes","reorder","setDragging","minItems","maxItems","showMinItemError","showMaxItemError","_","sortable","options","animation","ghostClass","onStart","onEnd","marginRight","App","Warning","Container","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","onClose","open","init","getValue","selectedSDKvalues","filteredIds","filter","isArray","sortBy","indexOf","updatedParams","frame","startAutoResizer","onReadOnlyChange","Render","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.db48f11b.chunk.js","sourcesContent":["\r\nexport const SET_PARAMS = 'SET_PARAMS';\r\nexport const setParams = params => ({\r\n  type: SET_PARAMS,\r\n  value: params\r\n});","export class ProductSelectorError extends Error {\r\n  static codes = {\r\n      INVALID_FIELD: 'INVALID_PROPERTY',\r\n      INVALID_VALUE: 'INVALID_VALUE',\r\n      GET_ITEMS: 'GET_ITEMS',\r\n      GET_SELECTED_ITEMS: 'GET_SELECTED_ITEMS',\r\n      GET_SDK: 'GET_SDK'\r\n  }\r\n  code = 'UNDEFINED'\r\n  constructor(message, code) {\r\n    super(message);\r\n    if (code) {\r\n      this.code = code;\r\n    }\r\n  }\r\n}","import qs from 'qs';\r\nimport { trimEnd } from 'lodash';\r\nimport { ProductSelectorError } from '../ProductSelectorError';\r\nexport class SFCC {\r\n  constructor(settings) {\r\n    this.settings = settings;\r\n  }\r\n\r\n  getHeaders(state) {\r\n    const {\r\n      params: { authSecret, authClientId, sfccUrl: endpoint }\r\n    } = state;\r\n    return {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'x-auth-id': authClientId,\r\n        'x-auth-secret': authSecret,\r\n        endpoint\r\n      }\r\n    };\r\n  }\r\n\r\n  async getItems(state, ids) {\r\n    const {\r\n      params: { siteId: site_id, proxyUrl }\r\n    } = state;\r\n    try {\r\n      const queryString = qs.stringify(\r\n        {\r\n          site_id,\r\n          ids\r\n        },\r\n        { arrayFormat: 'brackets' }\r\n      );\r\n      const params = {\r\n        method: 'GET',\r\n        ...this.getHeaders(state)\r\n      };\r\n      params.method = 'GET';\r\n      const response = await fetch(trimEnd(proxyUrl, '/') + '/products?' + queryString, params);\r\n      const { items } = await response.json();\r\n      return items;\r\n    } catch (e) {\r\n      console.error(e);\r\n      throw new ProductSelectorError('Could not get items', ProductSelectorError.codes.GET_SELECTED_ITEMS);\r\n    }\r\n  }\r\n\r\n  async search(state) {\r\n    const {\r\n      searchText,\r\n      page,\r\n      selectedCatalog,\r\n      params: { siteId, proxyUrl }\r\n    } = state;\r\n    const emptyResult = { items: [], page: { numPages: 0, curPage: 0, total: 0 } };\r\n\r\n    try {\r\n      const body = {\r\n        site_id: siteId,\r\n        search_text: searchText,\r\n        page: page.curPage\r\n      };\r\n\r\n      if (selectedCatalog !== null) {\r\n        body.catalog_id = selectedCatalog;\r\n      }\r\n      const params = {\r\n        method: 'POST',\r\n        body: JSON.stringify(body),\r\n        ...this.getHeaders(state)\r\n      };\r\n      const response = await fetch(trimEnd(proxyUrl, '/') + '/product-search', params);\r\n      return response.json() || emptyResult;\r\n    } catch (e) {\r\n      console.error(e);\r\n      throw new ProductSelectorError('Could not search', ProductSelectorError.codes.GET_ITEMS);\r\n    }\r\n  }\r\n\r\n  exportItem(item) {\r\n    return item.id;\r\n  }\r\n}\r\n","import { ProductService } from '@amplience/sap-product-browser';\r\nimport { ProductSelectorError } from '../ProductSelectorError';\r\n\r\nexport class Hybris {\r\n\r\n  constructor({ hybrisUrl } = {}) {\r\n    this.hybrisUrl = hybrisUrl;\r\n\r\n    this.productService = new ProductService(hybrisUrl, '/rest/v2', null);\r\n  }\r\n\r\n  async getItems(state, filterIds) {\r\n    const { params } = state;\r\n    const { currency } = params;\r\n\r\n    const getItem = async ({id, catalog}) => {\r\n      const item = await this.productService.getByCode(catalog, id, currency);\r\n\r\n      return this.itemModel(item, catalog);\r\n    };\r\n\r\n    try {\r\n      return Promise.all(filterIds.map(getItem));\r\n    } catch (e) {\r\n      console.error(e);\r\n      throw new ProductSelectorError('Could not get items', ProductSelectorError.codes.GET_SELECTED_ITEMS);\r\n    }\r\n  }\r\n\r\n  async search(state) {\r\n    try {\r\n      const { items, page } = await this._get(state);\r\n\r\n      return {\r\n        items,\r\n        page\r\n      };\r\n    } catch (e) {\r\n      console.error(e);\r\n      throw new ProductSelectorError('Could not get items', ProductSelectorError.codes.GET_ITEMS);\r\n    }\r\n  }\r\n\r\n  async _get(state) {\r\n    const { selectedCatalog, searchText, page, params } = state;\r\n    const { currency } = params;\r\n\r\n    const { products, pagination } = await this.productService.search(\r\n      selectedCatalog,\r\n      searchText,\r\n      currency,\r\n      page.curPage\r\n    );\r\n\r\n    const { totalResults: total, currentPage: curPage, totalPages: numPages } = pagination;\r\n\r\n    const pages = {\r\n      total,\r\n      curPage,\r\n      numPages\r\n    };\r\n\r\n    const items = products.map(item => this.itemModel(item, selectedCatalog));\r\n\r\n    return { items, page: pages };\r\n  }\r\n\r\n  getImage(item) {\r\n    const getProductImage = ({ images }) => images.find(({ format }) => format === 'product');\r\n    return item.images && item.images.length && getProductImage(item)\r\n      ? this.hybrisUrl + getProductImage(item).url\r\n      : item.defaultImageUrl;\r\n  }\r\n\r\n  stripHtml(html) {\r\n    const tmp = document.createElement('DIV');\r\n    tmp.innerHTML = html;\r\n    return tmp.textContent || tmp.innerText || '';\r\n  }\r\n\r\n  itemModel({ code, name, images, defaultImageUrl }, catalog) {\r\n    return {\r\n      id: code,\r\n      name: this.stripHtml(name),\r\n      image: this.getImage({ images, defaultImageUrl }),\r\n      catalog\r\n    };\r\n  }\r\n\r\n  exportItem({ id, catalog }) {\r\n    return {\r\n      id,\r\n      catalog\r\n    };\r\n  }\r\n}\r\n","import SdkAuth from '@commercetools/sdk-auth'\r\nimport {ProductSelectorError} from '../ProductSelectorError';\r\nimport qs from 'qs';\r\n\r\nexport class CommerceTools {\r\n  constructor({host, projectKey, clientId, clientSecret, apiUrl, scope = 'view_published_products', locale}) {\r\n\r\n    this.sdkAuth = new SdkAuth({\r\n      host,\r\n      projectKey,\r\n      disableRefreshToken: false,\r\n      credentials: {\r\n        clientId,\r\n        clientSecret,\r\n      },\r\n      scopes: [scope + ':' + projectKey],\r\n    });\r\n\r\n    this.apiUrl = apiUrl;\r\n    this.locale = locale;\r\n  }\r\n\r\n  async getHeaders() {\r\n    this.token = await this.sdkAuth.clientCredentialsFlow();\r\n    const {\r\n      token_type, access_token\r\n    } = this.token;\r\n\r\n    return {\r\n      headers: {\r\n        'Authorization': `${token_type} ${access_token}`\r\n      }\r\n    };\r\n  }\r\n\r\n  async getItems(state, filterIds = []) {\r\n    const {\r\n      PAGE_SIZE,\r\n      params: {\r\n        projectKey\r\n      }\r\n    } = state;\r\n    try {\r\n      if (!filterIds.length){\r\n        return [];\r\n      }\r\n      const headers = await this.getHeaders();\r\n      const idsStrings = '\"' + filterIds.join('\",\"') + '\"';\r\n\r\n      const params = {\r\n        method: 'GET',\r\n        ...headers\r\n      };\r\n\r\n      const queryString = qs.stringify(\r\n        {\r\n          staged: false,\r\n          limit: PAGE_SIZE,\r\n          where: `id in (${idsStrings})`\r\n        }\r\n      );\r\n\r\n      const response = await fetch(`${this.apiUrl}/${projectKey}/product-projections?${queryString}`, params);\r\n      const {results} = await response.json();\r\n\r\n      return this.parseResults(results);\r\n\r\n    } catch (e) {\r\n      console.error(e);\r\n      throw new ProductSelectorError('Could not get items', ProductSelectorError.codes.GET_SELECTED_ITEMS);\r\n    }\r\n  }\r\n\r\n  getImage({ attributes = [], images = [] }) {\r\n    const LARGE_IMAGE_KEY = 'largeImageUrl';\r\n    const largeImage = attributes.find(({ name = '' }) => name === LARGE_IMAGE_KEY);\r\n\r\n    if (largeImage && largeImage.value) {\r\n      return largeImage.value;\r\n    }\r\n\r\n    return images.length ? images[0].url : '';\r\n  }\r\n\r\n  parseResults(data) {\r\n    return data.map((item) => {\r\n      return {\r\n        id: item.id,\r\n        name: item.name[this.locale],\r\n        image: this.getImage(item.masterVariant),\r\n        key: item.key\r\n      }\r\n    })\r\n  }\r\n\r\n  async search(state) {\r\n    const {\r\n      searchText,\r\n      page,\r\n      PAGE_SIZE,\r\n      params: {projectKey}\r\n    } = state;\r\n\r\n    try {\r\n      const headers = await this.getHeaders();\r\n\r\n      const params = {\r\n        method: 'GET',\r\n        ...headers\r\n      };\r\n\r\n      const queryString = qs.stringify(\r\n        {\r\n          staged: false,\r\n          offset: page.curPage * PAGE_SIZE,\r\n          limit: PAGE_SIZE,\r\n          [`text.${this.locale}`]: searchText\r\n        }\r\n      );\r\n\r\n      const response = await fetch(`${this.apiUrl}/${projectKey}/product-projections/search?${queryString}`, params);\r\n      const {results, total} = await response.json();\r\n\r\n      return {\r\n        items: this.parseResults(results),\r\n        page: {\r\n          numPages: Math.ceil(total / PAGE_SIZE),\r\n          curPage: page.curPage,\r\n          total\r\n        }\r\n      };\r\n    } catch (e) {\r\n      console.error(e);\r\n      throw new ProductSelectorError('Could not search', ProductSelectorError.codes.GET_ITEMS);\r\n    }\r\n  }\r\n\r\n  exportItem(item) {\r\n    return item;\r\n  }\r\n}\r\n","import {SFCC} from './SFCC';\r\nimport {Hybris} from './Hybris';\r\nimport {CommerceTools} from './CommerceTools';\r\n\r\nexport const backends = {\r\n  SFCC: 'sfcc',\r\n  HYBRIS: 'hybris',\r\n  COMMERCETOOLS: 'commercetools'\r\n};\r\n\r\nexport const getBackend = (params) => {\r\n  switch (params.backend) {\r\n    case backends.HYBRIS:\r\n      return new Hybris(params);\r\n    case backends.COMMERCETOOLS:\r\n      return new CommerceTools(params);\r\n    case backends.SFCC:\r\n    default:\r\n      return new SFCC(params);\r\n  }\r\n}","import { getBackend } from '../../backends/backends';\r\n\r\nexport const SET_BACKEND = 'SET_BACKEND';\r\nexport const INIT_BACKEND = 'INIT_BACKEND';\r\n\r\nexport const initBackend = () => (dispatch, getState) => {\r\n  const { params } = getState();\r\n  const backend = getBackend(params);\r\n\r\n  dispatch(setBackend(backend));\r\n};\r\n\r\nexport const setBackend = value => ({\r\n  type: SET_BACKEND,\r\n  value\r\n});\r\n","import { getItems } from \"../items/items.actions\";\r\n\r\nexport const SET_PAGE = 'SET_PAGE';\r\nexport const setPage = value => ({\r\n  type: SET_PAGE,\r\n  value\r\n});\r\n\r\nexport const changePage = curPage => async (dispatch, getState) => {\r\n  const { page } = getState();\r\n  dispatch(setPage({...page, curPage }));\r\n  dispatch(getItems());\r\n}\r\n\r\n","export const SET_FETCHING = 'SET_FETCHING';\r\n\r\nexport const setFetching = value => ({\r\n  type: SET_FETCHING,\r\n  value\r\n});","export const SET_GLOBAL_ERROR = 'SET_GLOBAL_ERROR';\r\n\r\nexport const setGlobalError = value => ({\r\n  type: SET_GLOBAL_ERROR,\r\n  value\r\n});","import { map, trim, isEmpty, get } from 'lodash';\r\nimport { setPage } from '../pages/pages.actions';\r\nimport { setFetching } from '../fetching/fetching.actions';\r\nimport { setGlobalError } from '../global-error/global-error.actions';\r\n\r\nexport const SET_VALUE = 'SET_VALUE';\r\n\r\nexport const setValue = selectedItems => async (dispatch, getState) => {\r\n  const { SDK, backend } = getState();\r\n  try {\r\n    await SDK.field.setValue(map(selectedItems, item => backend.exportItem({ \r\n      component: 'ProductItem',\r\n      props: {\r\n        id: item.id,\r\n        key: item.key\r\n      }\r\n    })));\r\n  } catch (e) {\r\n    const error = get(e, '[0].data.keyword');\r\n    if (!error) {\r\n      dispatch(setGlobalError('Could not set value'));\r\n    }\r\n  }\r\n};\r\n\r\nexport const GET_ITEMS = 'GET_ITEMS';\r\n\r\nexport const getItems = () => async (dispatch, getState) => {\r\n  const state = getState();\r\n\r\n  if (isEmpty(trim(state.searchText))) {\r\n    const page = {\r\n      numPages: 0,\r\n      curPage: 0,\r\n      total: 0\r\n    };\r\n    dispatch(setPage(page));\r\n    dispatch(setItems([]));\r\n    return;\r\n  }\r\n\r\n  dispatch(setFetching(true));\r\n\r\n  let items = [];\r\n\r\n  try {\r\n    const { items: fetchedItems, page } = await state.backend.search(state);\r\n    items = fetchedItems;\r\n    dispatch(setPage(page));\r\n    dispatch(setItems(items));\r\n  } catch (e) {\r\n    dispatch(setGlobalError('Could not get items'));\r\n    console.error(e)\r\n  }\r\n\r\n  dispatch(setFetching(false));\r\n};\r\n\r\nexport const SET_ITEMS = 'SET_ITEMS';\r\n\r\nexport const setItems = value => ({\r\n  type: SET_ITEMS,\r\n  value\r\n});\r\n","export const SET_INITIALISED = 'SET_INITIALISED';\r\n\r\nexport const setInitialised = value => ({\r\n  type: SET_INITIALISED,\r\n  value\r\n});\r\n","import sortBy from 'lodash/sortBy';\r\nimport filter from 'lodash/filter';\r\nimport isEmpty from 'lodash/isEmpty';\r\nimport indexOf from 'lodash/indexOf';\r\nimport isArray from 'lodash/isArray';\r\n\r\nimport { setValue } from '../items/items.actions';\r\nimport { setFetching } from '../fetching/fetching.actions';\r\nimport { setInitialised } from '../initialised/initialised.actions';\r\nimport { ProductSelectorError } from '../../ProductSelectorError';\r\nimport { setTouched } from '../touched/touched.actions';\r\nimport { setGlobalError } from '../global-error/global-error.actions';\r\n\r\nexport const GET_SELECTED_ITEMS = 'GET_SELECTED_ITEMS';\r\nexport const SET_SELECTED_ITEMS = 'SET_SELECTED_ITEMS';\r\nexport const REMOVE_SELECTED_ITEM = 'REMOVE_SELECTED_ITEM';\r\nexport const ADD_SELECTED_ITEM = 'ADD_SELECTED_ITEM';\r\nexport const REORDER_SELECTED_ITEMS = 'REORDER_SELECTED_ITEM';\r\n\r\nexport const addItem = item => ({\r\n  type: ADD_SELECTED_ITEM,\r\n  value: item\r\n});\r\n\r\nexport const removeItem = item => ({\r\n  type: REMOVE_SELECTED_ITEM,\r\n  value: item\r\n});\r\n\r\nexport const setSelectedItems = value => ({\r\n  type: SET_SELECTED_ITEMS,\r\n  value\r\n});\r\n\r\nexport const reorder = indexes => ({\r\n  type: REORDER_SELECTED_ITEMS,\r\n  value: indexes\r\n});\r\n\r\nexport const toggleProduct = (item, isSelected) => async (dispatch, getState) => {\r\n  dispatch(isSelected ? removeItem(item) : addItem(item));\r\n  dispatch(setTouched(true));\r\n\r\n  const { selectedItems } = getState();\r\n\r\n  dispatch(setValue(selectedItems));\r\n};\r\n\r\nexport const reorderItems = indexes => (dispatch, getState) => {\r\n  dispatch(reorder(indexes));\r\n  const { selectedItems } = getState();\r\n  dispatch(setValue(selectedItems));\r\n};\r\n\r\nexport const getSelectedItems = () => async (dispatch, getState) => {\r\n  const state = getState();\r\n  const { SDK, backend } = state;\r\n\r\n  dispatch(setFetching(true));\r\n\r\n  let selectedItems = [];\r\n\r\n  try {\r\n    const selectedSDKvalues = await SDK.field.getValue();\r\n    \r\n    const ids = selectedSDKvalues.map(item => item.props.id);\r\n\r\n    const filteredIds = filter(ids, item => !isEmpty(item));\r\n\r\n    if (filteredIds && filteredIds.length) {\r\n      const items = await backend.getItems(state, filteredIds);\r\n\r\n      if (!isArray(items)) {\r\n        throw new ProductSelectorError('Field value is not an array', ProductSelectorError.codes.INVALID_VALUE);\r\n      }\r\n\r\n      selectedItems = items;\r\n    }\r\n\r\n    selectedItems = sortBy(selectedItems, ({ id }) => indexOf(ids, id));\r\n\r\n    if (selectedItems.length !== ids.length) {\r\n      dispatch(setValue(selectedItems));\r\n    }\r\n    dispatch(setSelectedItems(selectedItems));\r\n\r\n    dispatch(setFetching(false));\r\n    dispatch(setInitialised(true));\r\n  } catch (e) {\r\n    console.error('could not load', e);\r\n    dispatch(setFetching(false));\r\n    dispatch(setInitialised(true));\r\n    dispatch(setGlobalError('Could not get selected items'));\r\n  }\r\n};\r\n","import { changePage } from \"../pages/pages.actions\";\r\n\r\nexport const SET_CATALOG = 'SET_CATALOG';\r\n\r\nexport const setCatalog = value => ({\r\n  type: SET_CATALOG,\r\n  value\r\n});\r\n\r\nexport const changeCatalog = value => async dispatch => {\r\n  dispatch(setCatalog(value));\r\n  dispatch(changePage(0));\r\n}","import { init } from \"dc-extensions-sdk\";\r\nimport { setParams } from \"../params/params.actions\";\r\nimport { initBackend } from '../backend/backend.actions';\r\nimport { getSelectedItems } from '../selectedItems/selectedItems.actions';\r\nimport { setFetching } from '../fetching/fetching.actions';\r\nimport { setGlobalError } from '../global-error/global-error.actions';\r\nimport { setCatalog } from '../catalog/catalog.actions';\r\nimport { setInitialised } from \"../initialised/initialised.actions\";\r\n\r\nexport const SET_SDK = 'SET_SDK';\r\n\r\nexport const setSDK = value => ({\r\n  type: SET_SDK,\r\n  value\r\n});\r\n\r\nexport const fetchSDK = () => async (dispatch, getState) => {\r\n  let { SDK } = getState();\r\n\r\n  if (SDK) {\r\n    return SDK;\r\n  }\r\n\r\n  dispatch(setFetching(true));\r\n\r\n  try {\r\n    SDK = await init();\r\n\r\n    dispatch(setSDK(SDK));\r\n    dispatch(setParams(SDK.params));\r\n    dispatch(initBackend());\r\n    const {params} = getState();\r\n    \r\n    if (params.catalogs.length) {\r\n      dispatch(setCatalog(params.catalogs[0].id));\r\n    }\r\n    dispatch(getSelectedItems());\r\n    const {params: updatedParams} = getState();\r\n    \r\n    if (updatedParams.catalogs.length !== params.catalogs.length) {\r\n      dispatch(setCatalog(updatedParams.catalogs[0].id));\r\n    }\r\n    dispatch(setFetching(false));\r\n    SDK.frame.startAutoResizer();\r\n    SDK.form.onReadOnlyChange(readOnly => {\r\n      dispatch(setSDK({ ...SDK, form: { ...SDK.form, readOnly } }))\r\n    })\r\n  }\r\n  catch (e) {\r\n    console.error('Failed to load', e);    \r\n    dispatch(setFetching(false));\r\n    dispatch(setInitialised(true));\r\n    dispatch(setGlobalError('Could not get SDK'));\r\n  }\r\n\r\n\r\n  return SDK;\r\n}","import { SET_PAGE } from \"./pages.actions\";\r\n\r\nconst initalState = {\r\n  numPages: 0,\r\n  curPage: 0,\r\n  total: 0\r\n};\r\n\r\nexport function pagesReducer(state = initalState, action) {\r\n  switch (action.type) {\r\n    case SET_PAGE:\r\n      return {...state, ...action.value};\r\n    default:\r\n      return state;\r\n  }\r\n}","import { toLower } from 'lodash';\r\nimport { SET_PARAMS } from \"./params.actions\";\r\n\r\nexport const params = {\r\n  proxyUrl: '',\r\n  sfccUrl: '',\r\n  authSecret: '',\r\n  authClientId: '',\r\n  siteId: '',\r\n  currency: 'USD',\r\n  catalogs: [],\r\n  backend: 'SFCC',\r\n  noItemsText: 'No items selected.',\r\n  searchPlaceholderText: 'Search'\r\n};\r\n\r\nexport function paramReducer(state = params, {type, value}) {\r\n  switch (type) {\r\n    case SET_PARAMS:\r\n      const {installation, instance} = (value || {});\r\n      const selectedParams = {...installation, ...instance};\r\n      return {...state, ...selectedParams, backend: toLower(selectedParams.backend)};\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import thunkMiddleware from 'redux-thunk';\r\n\r\nimport { createStore, applyMiddleware, combineReducers, compose } from 'redux';\r\n\r\nimport { sdkReducer } from './sdk/sdk.reducer';\r\nimport { pagesReducer } from './pages/pages.reducer'\r\nimport { itemsReducer } from './items/items.reducer';\r\nimport { paramReducer } from './params/params.reducer';\r\nimport { backendReducer } from './backend/backend.reducer';\r\nimport { touchedReducer } from './touched/touched.reducer';\r\nimport { catalogReducer } from './catalog/catalog.reducer';\r\nimport { fetchingReducer } from './fetching/fetching.reducer';\r\nimport { searchTextReducer } from './searchText/searchText.reducer';\r\nimport { initialisedReducer } from './initialised/initialised.reducer';\r\nimport { selectedItemsReducer } from './selectedItems/selectedItems.reducer';\r\nimport { globalErrorReducer } from './global-error/global-error.reducer';\r\n\r\nexport const rootReducer = combineReducers({\r\n  SDK: sdkReducer,\r\n  page: pagesReducer,\r\n  items: itemsReducer,\r\n  params: paramReducer,\r\n  backend: backendReducer,\r\n  touched: touchedReducer,\r\n  isFetching: fetchingReducer,\r\n  searchText: searchTextReducer,\r\n  initialised: initialisedReducer,\r\n  selectedCatalog: catalogReducer,\r\n  selectedItems: selectedItemsReducer,\r\n  globalError: globalErrorReducer,\r\n  PAGE_SIZE: (state = 20) => state,\r\n});\r\n\r\nconst composeEnhancer = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nexport const store = createStore(\r\n  rootReducer,\r\n  composeEnhancer(applyMiddleware(thunkMiddleware))\r\n);\r\n","import { SET_SDK } from \"./sdk.actions\";\r\n\r\nexport function sdkReducer(state = null, action) {\r\n  switch(action.type) {\r\n    case SET_SDK:\r\n      return action.value;\r\n    default:\r\n      return state;\r\n  }\r\n}","import { SET_ITEMS } from \"./items.actions\";\r\n\r\nexport function itemsReducer(state = [], action) {\r\n  switch (action.type) {\r\n    case SET_ITEMS:\r\n      return action.value;\r\n      \r\n    default:\r\n      return state;\r\n  }\r\n}","import { SET_BACKEND } from \"./backend.actions\";\r\n\r\nexport function backendReducer(state = {}, action) {\r\n  switch (action.type) {\r\n    case SET_BACKEND:\r\n      return action.value;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { SET_TOUCHED } from \"./touched.actions\";\r\n\r\nexport function touchedReducer(state = false, action) {\r\n  switch (action.type) {\r\n    case SET_TOUCHED:\r\n      return action.value;\r\n    default:\r\n      return state;\r\n  }\r\n}","export const SET_TOUCHED = 'SET_TOUCHED';\r\nexport const setTouched = value => ({\r\n  type: SET_TOUCHED,\r\n  value\r\n});","import { SET_FETCHING } from \"./fetching.actions\";\r\n\r\nexport function fetchingReducer(state = false, action) {\r\n  switch (action.type) {\r\n    case SET_FETCHING:\r\n      return action.value;\r\n    default:\r\n      return state;\r\n  }\r\n}","import { SET_SEARCH_TEXT } from \"./searchText.actions\";\r\n\r\nexport function searchTextReducer(state = '', action) {\r\n  switch (action.type) {\r\n    case SET_SEARCH_TEXT:\r\n      return action.value;\r\n    default:\r\n      return state;\r\n  }\r\n}","export const SET_SEARCH_TEXT = 'SET_SEARCH_TEXT';\r\n\r\nexport const setSearchText = value => ({\r\n  type: SET_SEARCH_TEXT,\r\n  value\r\n});\r\n","import { SET_INITIALISED } from \"./initialised.actions\";\r\n\r\nexport function initialisedReducer(state = false, action) {\r\n  switch (action.type) {\r\n    case SET_INITIALISED:\r\n      return action.value;\r\n    default:\r\n      return state;\r\n  }\r\n}","import { SET_CATALOG } from './catalog.actions';\r\n\r\nexport function catalogReducer(state = null, action) {\r\n  switch (action.type) {\r\n    case SET_CATALOG:\r\n      return action.value;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { reject, slice } from 'lodash';\r\n\r\nimport {\r\n  SET_SELECTED_ITEMS,\r\n  REMOVE_SELECTED_ITEM,\r\n  ADD_SELECTED_ITEM,\r\n  REORDER_SELECTED_ITEMS\r\n} from './selectedItems.actions';\r\n\r\nexport function selectedItemsReducer(state = [], action) {\r\n  switch (action.type) {\r\n    case SET_SELECTED_ITEMS:\r\n      return action.value;\r\n    case REMOVE_SELECTED_ITEM:\r\n      return reject(state, { id: action.value.id });\r\n    case ADD_SELECTED_ITEM:\r\n      return [...state, action.value];\r\n    case REORDER_SELECTED_ITEMS:\r\n      const { oldIndex, newIndex } = action.value;\r\n      const itemToMove = state[oldIndex];\r\n      const remainingItems = reject(state, { id: itemToMove.id });\r\n      const reorderedItems = [...slice(remainingItems, 0, newIndex), itemToMove, ...slice(remainingItems, newIndex)];\r\n\r\n      return reorderedItems;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { SET_GLOBAL_ERROR } from './global-error.actions';\r\n\r\nexport function globalErrorReducer(state = null, action) {\r\n  switch (action.type) {\r\n    case SET_GLOBAL_ERROR:\r\n      return action.value;\r\n    default:\r\n      return state;\r\n  }\r\n}","import { createMuiTheme } from '@material-ui/core/styles';\r\n\r\nexport const theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: '#039be5'\r\n    },\r\n    secondary: {\r\n      main: '#1ab0f9'\r\n    },\r\n    error: {\r\n      main: '#ff3366'\r\n    }\r\n  }\r\n});","import React from 'react';\r\nimport { debounce, isUndefined, trim } from 'lodash';\r\nimport { connect } from 'react-redux';\r\nimport { Paper, InputBase, Divider, makeStyles } from '@material-ui/core';\r\nimport { Search } from '@material-ui/icons';\r\nimport { changePage } from '../store/pages/pages.actions';\r\nimport { setSearchText } from '../store/searchText/searchText.actions';\r\nimport { setGlobalError } from '../store/global-error/global-error.actions';\r\n\r\nconst styles = makeStyles(theme => ({\r\n  root: {\r\n    width: '100%',\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  search: {\r\n    padding: '2px 4px',\r\n    display: 'flex',\r\n    alignItems: 'center'\r\n  },\r\n  input: {\r\n    marginLeft: theme.spacing(1),\r\n    flex: 1\r\n  },\r\n  icon: {\r\n    padding: 10,\r\n    fill: 'rgba(0, 0, 0, 0.54)'\r\n  },\r\n  divider: {\r\n    height: 28,\r\n    margin: 4\r\n  }\r\n}));\r\n\r\nconst debouncedSearch = debounce(async (setGlobalError, changePage) => {\r\n  try {\r\n    changePage(0);\r\n  } catch (e) {\r\n    setGlobalError('Error getting products');\r\n  }\r\n}, 1000);\r\n\r\nexport const SearchBoxComponent = params => {\r\n  const classes = styles();\r\n\r\n  const search = event => {\r\n    const searchText = !isUndefined(event.target.value) ? event.target.value : params.searchText;\r\n    params.setSearchText(trim(searchText));\r\n    debouncedSearch(params.setGlobalError, params.changePage);\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Paper className={classes.search}>\r\n        <InputBase\r\n          value={params.searchText}\r\n          className={classes.input}\r\n          placeholder={params.params.searchPlaceholderText}\r\n          inputProps={{ 'aria-label': 'search' }}\r\n          onChange={search}\r\n        />\r\n        <Divider className={classes.divider} orientation=\"vertical\" />\r\n        <Search className={classes.icon} />\r\n      </Paper>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst SearchBox = connect(\r\n  state => ({\r\n    params: state.params,\r\n    searchText: state.searchText,\r\n  }),\r\n  { changePage, setSearchText, setGlobalError }\r\n)(SearchBoxComponent);\r\n\r\nexport default SearchBox;\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { ButtonGroup, Button, makeStyles } from '@material-ui/core';\r\nimport { SkipNext, SkipPrevious, ArrowRight, ArrowLeft } from '@material-ui/icons';\r\n\r\nimport take from 'lodash/take';\r\nimport range from 'lodash/range';\r\nimport takeRight from 'lodash/takeRight';\r\n\r\nimport { changePage } from '../store/pages/pages.actions';\r\n\r\nconst styles = makeStyles(theme => ({\r\n  root: {\r\n    marginTop: theme.spacing(1)\r\n  }\r\n}));\r\n\r\nexport const PagerComponent = ({ changePage, page: { numPages, curPage } }) => {\r\n  const classes = styles();\r\n  const NUM_START_PAGES = 3;\r\n  const NUM_END_PAGES = 3;\r\n  const NUM_VISIBLE_PAGES = 6;\r\n  const allPages = range(numPages);\r\n  let pages = [];\r\n\r\n  if (curPage - NUM_START_PAGES < 0) {\r\n    pages = take(allPages, NUM_VISIBLE_PAGES);\r\n  } else if (curPage + NUM_END_PAGES > numPages) {\r\n    pages = takeRight(allPages, NUM_VISIBLE_PAGES);\r\n  } else {\r\n    const startPages = range(curPage - NUM_START_PAGES, curPage);\r\n    const endPages = range(curPage, curPage + NUM_END_PAGES);\r\n    pages = take([...startPages, ...endPages], NUM_VISIBLE_PAGES);\r\n  }\r\n\r\n  return (\r\n    <ButtonGroup color=\"primary\" className={classes.root}>\r\n      <Button aria-label=\"first\" onClick={() => changePage(0)} disabled={curPage === 0}>\r\n        <SkipPrevious fontSize=\"small\" />\r\n      </Button>\r\n      <Button aria-label=\"previous\" onClick={() => changePage(curPage - 1)} disabled={curPage === 0}>\r\n        <ArrowLeft fontSize=\"small\" />\r\n      </Button>\r\n      {pages.map(page => (\r\n        <Button variant={page === curPage ? 'contained' : null} key={page} onClick={() => changePage(page)}>\r\n          {page + 1}\r\n        </Button>\r\n      ))}\r\n      <Button aria-label=\"next\" onClick={() => changePage(curPage + 1)} disabled={curPage === numPages - 1}>\r\n        <ArrowRight fontSize=\"small\" />\r\n      </Button>\r\n      <Button aria-label=\"last\" onClick={() => changePage(numPages - 1)} disabled={curPage === numPages - 1}>\r\n        <SkipNext fontSize=\"small\" />\r\n      </Button>\r\n    </ButtonGroup>\r\n  );\r\n};\r\n\r\nconst Pager = connect(state => ({ page: state.page }), { changePage })(PagerComponent);\r\n\r\nexport default Pager;\r\n","import React from 'react';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\n\r\nconst FadeIn = ({ show = true, children, exitOptions = {}, className = '' }) => {\r\n  return (\r\n    <AnimatePresence>\r\n      {show && (\r\n        <motion.div \r\n          className={className}\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          exit={{ opacity: 0, ...exitOptions }}>\r\n          {children}\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default FadeIn;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Clear } from '@material-ui/icons';\r\nimport { Card, CardActionArea, CardMedia, CardHeader, IconButton, makeStyles } from '@material-ui/core';\r\nimport { toggleProduct } from '../store/selectedItems/selectedItems.actions';\r\n\r\nimport find from 'lodash/find';\r\nimport FadeIn from '../fade-in/FadeIn';\r\n\r\nimport './product.scss';\r\n\r\nconst styles = makeStyles(theme => ({\r\n\troot: {\r\n\t\tdisplay: 'flex',\r\n\t\tflex: '1 1 auto',\r\n\t\tflexDirection: 'column',\r\n\t\twidth: '100%',\r\n\t\ttransition: 'border-width 0.3s',\r\n\t\tborder: ({ isSelected }) => (isSelected ? `1px solid ${theme.palette.grey[500]}` : 'none'),\r\n\t\tmargin: ({ isSelected }) => (isSelected ? '6px' : theme.spacing(1)),\r\n\t\topacity: ({ readOnly }) => readOnly ? '0.6' : '',\r\n\t\tpointerEvents: ({ readOnly }) => readOnly ? 'none' : ''\r\n\t},\r\n\tcardWrapper: {\r\n\t\theight: '100%',\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\tthumbnail: {\r\n\t\tpaddingBottom: '100%',\r\n\t\tmarginTop: 'auto',\r\n\t\tbackgroundColor: ({ hasImage }) => (hasImage ? 'transparent' : theme.palette.grey[100])\r\n\t},\r\n\tremoveBtn: {\r\n\t\tmarginLeft: theme.spacing(1)\r\n\t}\r\n}));\r\n\r\nexport const ProductComponent = params => {\r\n\tconst [visible, setVisible] = useState(false);\r\n\tconst isRemovable = params.variant === 'removable';\r\n\tconst isSelected = Boolean(find(params.selectedItems, { id: params.item.id }));\r\n\tconst { readOnly } = params.SDK.form;\r\n\tconst toggle = () => params.toggleProduct(params.item, isSelected);\r\n\r\n\tconst hideProduct = () => {\r\n\t\tsetVisible(true);\r\n\t\ttoggle();\r\n\t};\r\n\r\n\tuseEffect(() => setVisible(true), []);\r\n\r\n\tconst { name, image } = params.item;\r\n\r\n\tconst classes = styles({\r\n\t\tisSelected,\r\n\t\treadOnly,\r\n\t\thasImage: Boolean(image)\r\n\t});\r\n\r\n\tconst cardMedia = (\r\n\t\t<CardMedia\r\n\t\t\tclassName={classes.thumbnail}\r\n\t\t\timage={image || '/images/image-icon.svg'}\r\n\t\t\ttitle={name}>\r\n\t\t</CardMedia>\r\n\t);\r\n\r\n\tconst CardAction = () => (\r\n\t\t<IconButton \r\n\t\t\taria-label=\"Remove\"\r\n\t\t\tonClick={hideProduct}\r\n\t\t\tclassName={classes.removeBtn}>\r\n\t\t\t<Clear />\r\n\t\t</IconButton>\r\n\t);\r\n\r\n\tconst cardBody = (\r\n\t\tisRemovable ?\r\n\t\t\tcardMedia :\r\n\t\t\t<CardActionArea>{cardMedia}</CardActionArea>\r\n\t);\r\n\r\n\treturn (\r\n\t\t<FadeIn \r\n\t\t\tshow={visible}\r\n\t\t\tclassName={classes.cardWrapper}>\r\n\t\t\t<Card \r\n\t\t\t\tclassName={'product ' + classes.root}\r\n\t\t\t\traised={isSelected}\r\n\t\t\t\tonClick={isRemovable ? null : toggle}>\r\n\t\r\n\t\t\t\t<CardHeader\r\n\t\t\t\t\taction={isRemovable && <CardAction />}\r\n\t\t\t\t\ttitle={params.item.name}\r\n\t\t\t\t\tsubheader={'Product ID: ' + params.item.id}\r\n\t\t\t\t\ttitleTypographyProps={{ variant: 'subtitle1' }}\r\n\t\t\t\t\tsubheaderTypographyProps={{ variant: 'body2' }}/>\r\n\r\n\t\t\t\t{cardBody}\r\n\t\t\t</Card>\r\n\t\t</FadeIn>\r\n\t);\r\n};\r\n\r\nconst Product = connect(\r\n\t({ selectedItems, backend, SDK }) => ({ selectedItems, backend, SDK }),\r\n\t({ toggleProduct })\r\n)(ProductComponent);\r\n\r\nexport default Product;\r\n","import React, { useState, useEffect } from 'react';\r\n\r\nimport { connect } from 'react-redux';\r\nimport { changeCatalog, setCatalog } from '../store/catalog/catalog.actions';\r\nimport { Select, MenuItem, InputLabel, FormControl, makeStyles } from '@material-ui/core';\r\n\r\nconst styles = makeStyles(theme => ({\r\n  root: {\r\n    marginLeft: 'auto',\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  select: {\r\n    minWidth: 200\r\n  }\r\n}));\r\n\r\nexport const CatalogSelectorComponent = params => {\r\n  const [labelWidth, setLabelWidth] = useState(0);\r\n  const [selectedCatalog, setSelectedCatalog] = useState(params.selectedCatalog);\r\n\r\n  const classes = styles();\r\n  const inputLabel = React.useRef(null);\r\n\r\n  const selectCatalog = event => {\r\n    const newCatalog = event.target.value;\r\n    if (newCatalog === selectedCatalog) {\r\n      return;\r\n    }\r\n    setSelectedCatalog(newCatalog);\r\n    if (params.searchText.length) {\r\n      params.changeCatalog(newCatalog);\r\n    } else {\r\n      params.setCatalog(newCatalog);\r\n    }\r\n  };\r\n\r\n  useEffect(() => setLabelWidth(inputLabel.current.offsetWidth), []);\r\n\r\n  return (\r\n    <FormControl variant=\"outlined\" className={classes.root}>\r\n      <InputLabel id=\"catalog\" ref={inputLabel}>\r\n        Catalog\r\n      </InputLabel>\r\n      <Select\r\n        className={classes.select}\r\n        labelId=\"catalog\"\r\n        onChange={selectCatalog}\r\n        labelWidth={labelWidth}\r\n        value={selectedCatalog || ''}\r\n      >\r\n        {params.catalogs.map(({ id, name }) => (\r\n          <MenuItem key={id} value={id}>\r\n            {name}\r\n          </MenuItem>\r\n        ))}\r\n      </Select>\r\n    </FormControl>\r\n  );\r\n};\r\n\r\nconst CatalogSelector = connect(\r\n  state => ({\r\n    catalogs: state.params.catalogs,\r\n    searchText: state.searchText,\r\n    selectedCatalog: state.selectedCatalog,\r\n    backend: state.backend\r\n  }),\r\n  { changeCatalog, setCatalog }\r\n)(CatalogSelectorComponent);\r\n\r\nexport default CatalogSelector;\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Typography } from '@material-ui/core';\r\n\r\nexport const PaginationSummaryComponent = params => {\r\n  const start = params.PAGE_SIZE * params.curPage;\r\n  const first = start + 1;\r\n  const last = Math.min(start + params.PAGE_SIZE, params.total);\r\n\r\n  return <Typography variant=\"body1\">{`Showing ${first} to ${last} of ${params.total}`}</Typography>;\r\n};\r\n\r\nconst PaginationSummary = connect(\r\n  state => ({\r\n    total: state.page.total,\r\n    curPage: state.page.curPage,\r\n    PAGE_SIZE: state.PAGE_SIZE\r\n  }),\r\n  {}\r\n)(PaginationSummaryComponent);\r\n\r\nexport default PaginationSummary;\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { CircularProgress, Grid, makeStyles } from '@material-ui/core';\r\n\r\nimport Pager from '../pager/Pager';\r\nimport FadeIn from '../fade-in/FadeIn';\r\nimport Product from '../product/Product';\r\nimport CatalogSelector from '../catalog-selector/CatalogSelector';\r\nimport PaginationSummary from '../pagination-summary/PaginationSummary';\r\n\r\nconst styles = makeStyles(theme => ({\r\n  root: {\r\n    width: '100%',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    flexDirection: 'column'\r\n  },\r\n  items: {\r\n    display: 'grid',\r\n    gridTemplateColumns: '100%',\r\n    justifyContent: 'space-between',\r\n    width: '100%',\r\n    '@media(min-width: 450px)': {\r\n      gridTemplateColumns: '50% 50%'\r\n    },\r\n    '@media(min-width: 800px)': {\r\n      gridTemplateColumns: '25% 25% 25% 25%'\r\n    },\r\n    '@media(min-width: 1024px)': {\r\n      gridTemplateColumns: '20% 20% 20% 20% 20%'\r\n    }\r\n  },\r\n  loader: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}));\r\n\r\nexport const ProductsGridComponent = params => {\r\n  const classes = styles();\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Grid container alignItems=\"center\">\r\n        <Grid item xs={6}>\r\n          <FadeIn show={params.items.length && !params.loading}>\r\n            <PaginationSummary />\r\n          </FadeIn>\r\n        </Grid>\r\n        <Grid item container xs={6}>\r\n          {params.catalogs.length && params.initialised ? <CatalogSelector /> : ''}\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <FadeIn \r\n        show={params.loading}\r\n        exitOptions={{ position: 'absolute' }}>\r\n        <CircularProgress className={classes.loader} />\r\n      </FadeIn>\r\n  \r\n      <div className={classes.items}>\r\n        {\r\n          !params.loading &&\r\n          params.items.map(item => <Product key={item.id} item={item} />)\r\n        }\r\n      </div>\r\n  \r\n      <FadeIn show={params.items.length && !params.loading}>\r\n        <Pager />\r\n      </FadeIn>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ProductsGrid = connect(\r\n  state => ({\r\n    items: state.items,\r\n    loading: state.isFetching,\r\n    initialised: state.initialised,\r\n    catalogs: state.params.catalogs,\r\n    backend: state.backend\r\n  }),\r\n  null\r\n)(ProductsGridComponent);\r\n\r\nexport default ProductsGrid;\r\n","import React from 'react';\r\nimport { FormHelperText } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/styles';\r\n\r\nimport FadeIn from '../fade-in/FadeIn';\r\n\r\nconst styles = makeStyles(theme => ({\r\n  error: {\r\n    marginTop: theme.spacing(1)\r\n  }\r\n}));\r\n\r\nconst FormError = ({ show = true, children }) => {\r\n  const classes = styles();\r\n\r\n  return (\r\n    <FadeIn show={show}>\r\n      <FormHelperText error={true} className={classes.error}>\r\n        {children}\r\n      </FormHelperText>\r\n    </FadeIn>\r\n  );\r\n};\r\n\r\nexport default FormError;\r\n","import React, { useState } from 'react';\r\nimport get from 'lodash/get';\r\nimport { connect } from 'react-redux';\r\nimport { motion } from 'framer-motion';\r\nimport { makeStyles, CircularProgress, Paper, Typography, Box } from '@material-ui/core';\r\n\r\nimport { reorderItems } from '../store/selectedItems/selectedItems.actions';\r\n\r\nimport Sortable from 'react-sortablejs';\r\nimport FadeIn from '../fade-in/FadeIn';\r\nimport Product from '../product/Product';\r\nimport FormError from '../form-error/FormError';\r\n\r\nimport './selected-products.scss';\r\n\r\nconst styles = makeStyles(theme => ({\r\n  root: {\r\n    width: '100%',\r\n    minHeight: '200px',\r\n    margin: theme.spacing(2),\r\n    padding: theme.spacing(2),\r\n    backgroundColor: theme.palette.grey[100],\r\n    boxSizing: 'border-box',\r\n    overflow: 'hidden',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    position: 'relative'\r\n  },\r\n  dragItem: {\r\n    transition: 'flex 0.15s, opacity 0.15s'\r\n  },\r\n  title: {\r\n    fontWeight: 700\r\n  },\r\n  items: {\r\n    margin: 'auto',\r\n    width: '100%',\r\n    zIndex: 2,\r\n    display: 'grid',\r\n    gridTemplateColumns: '100%',\r\n    '@media(min-width: 450px)': {\r\n      gridTemplateColumns: '50% 50%'\r\n    },\r\n    '@media(min-width: 800px)': {\r\n      gridTemplateColumns: '25% 25% 25% 25%'\r\n    },\r\n    '@media(min-width: 1024px)': {\r\n      gridTemplateColumns: '20% 20% 20% 20% 20%'\r\n    }\r\n  },\r\n  errorWrapper: {\r\n    height: '20px',\r\n    marginTop: 'auto'\r\n  },\r\n  loader: {\r\n    margin: 'auto',\r\n    alignSelf: 'center'\r\n  },\r\n  placeholder: {\r\n    margin: '-12px 0 0 0',\r\n    position: 'absolute',\r\n    width: '100%',\r\n    textAlign: 'center',\r\n    top: '50%'\r\n  }\r\n}));\r\n\r\nexport const SelectedProductsComponent = params => {\r\n  const [isDragging, setDragging] = useState(false);\r\n  const { minItems, maxItems } = get(params.SDK, 'field.schema', {});\r\n  const { readOnly } = get(params.SDK, 'form', {});\r\n  const classes = styles({ readOnly });\r\n  const showMinItemError = params.touched && minItems && params.selectedItems.length < minItems;\r\n  const showMaxItemError = params.touched && maxItems && params.selectedItems.length > maxItems;\r\n\r\n  const items = params.selectedItems.length ? (\r\n    <ProductList selectedItems={params.selectedItems} classes={classes} isDragging={isDragging}/>\r\n  ) : (\r\n    <NoItems classes={classes} noItemsText={params.params.noItemsText} />\r\n  );\r\n\r\n  return (\r\n    <Paper className={'selected-products ' + classes.root}>\r\n      <Typography variant=\"subtitle1\" component=\"h2\" className={classes.title}>\r\n        {get(params.SDK, 'field.schema.title', 'Selected products')}\r\n      </Typography>\r\n\r\n      <Loading show={!params.initialised} className={classes.loader} />\r\n\r\n      <FadeIn show={params.initialised}>\r\n        {readOnly && <div className={classes.items}>{items}</div>}\r\n        {!readOnly && (\r\n          <Sortable\r\n            onChange={(_, sortable, indexes) => params.reorderItems(indexes)}\r\n            className={classes.items}\r\n            options={{\r\n              animation: 150,\r\n              ghostClass: 'product-placeholder',\r\n              onStart: () => setDragging(true),\r\n              onEnd: () => setDragging(false)\r\n            }}\r\n          >\r\n            {items}\r\n          </Sortable>\r\n        )}\r\n        \r\n      </FadeIn>\r\n\r\n      <div className={classes.errorWrapper}>\r\n        <FormError show={Boolean(showMinItemError)}>You must select a minimum of {minItems} items</FormError>\r\n        <FormError show={Boolean(showMaxItemError)}>You must select a maximum of {maxItems} items</FormError>\r\n      </div>\r\n    </Paper>\r\n  );\r\n};\r\n\r\nconst ProductList = ({ selectedItems, classes, isDragging }) => {\r\n  return selectedItems.map(item => (\r\n    <motion.div positionTransition={isDragging ? null : {type: 'tween'}} key={item.id}>\r\n      <Product className={classes.dragItem} item={item} variant=\"removable\" />\r\n    </motion.div>\r\n  ));\r\n};\r\n\r\nconst Loading = ({ show, className }) => (\r\n  <FadeIn\r\n    show={show}\r\n    className={className}\r\n    exitOptions={{position: 'absolute', zIndex: 3, top: '50%', marginTop: '-20px'}}\r\n  >\r\n    <CircularProgress />\r\n  </FadeIn>\r\n);\r\n\r\nconst NoItems = ({ classes, noItemsText }) => (\r\n  <Typography component=\"div\" variant=\"body1\" className={classes.placeholder}>\r\n    <Box fontWeight=\"fontWeightLight\">{noItemsText}</Box>\r\n  </Typography>\r\n);\r\n\r\nconst SelectedProducts = connect(\r\n  state => ({\r\n    selectedItems: state.selectedItems,\r\n    SDK: state.SDK,\r\n    params: state.params,\r\n    touched: state.touched,\r\n    backend: state.backend,\r\n    initialised: state.initialised\r\n  }),\r\n  { reorderItems }\r\n)(SelectedProductsComponent);\r\n\r\nexport default SelectedProducts;\r\n","import React from 'react';\r\n\r\nimport { theme } from './theme';\r\nimport { connect } from 'react-redux';\r\nimport { Warning } from '@material-ui/icons';\r\nimport { setGlobalError } from './store/global-error/global-error.actions';\r\nimport { makeStyles, Container, Snackbar } from '@material-ui/core';\r\n\r\nimport SearchBox from './search-box/SearchBox';\r\nimport ProductsGrid from './products-grid/ProductsGrid';\r\nimport SelectedProducts from './selected-products/SelectedProducts';\r\n\r\nconst styles = makeStyles(() => ({\r\n  root: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center'\r\n  },\r\n  message: {\r\n    display: 'flex',\r\n    alignItems: 'center'\r\n  },\r\n  icon: {\r\n    marginRight: theme.spacing(1)\r\n  }\r\n}));\r\n\r\n\r\nconst AppComponent = params => {\r\n  const classes = styles();\r\n\r\n  const message = (\r\n    <span className={classes.message}>\r\n      <Warning className={classes.icon} />\r\n      {params.globalError}\r\n    </span>\r\n  );\r\n\r\n  return (\r\n    <Container className={classes.root}>\r\n      <Snackbar\r\n        anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\r\n        autoHideDuration={3000}\r\n        onClose={() => params.setGlobalError(null)}\r\n        open={Boolean(params.globalError)}\r\n        message={message}\r\n      />\r\n      <SelectedProducts />\r\n      <SearchBox />\r\n      <ProductsGrid />\r\n    </Container>\r\n  );\r\n};\r\n\r\nconst App = connect(\r\n  state => ({ globalError: state.globalError }),\r\n  { setGlobalError }\r\n)(AppComponent);\r\n\r\nexport default App;\r\n","import 'react-app-polyfill/stable';\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport { store } from './store/store';\r\nimport { theme } from './theme';\r\nimport { Provider } from 'react-redux';\r\nimport { fetchSDK } from './store/sdk/sdk.actions';\r\nimport { MuiThemeProvider } from '@material-ui/core';\r\n\r\nimport App from './App';\r\n\r\nimport './index.scss';\r\n\r\nstore.dispatch(fetchSDK());\r\n\r\nconst Render = () => (\r\n  <Provider store={store}>\r\n    <MuiThemeProvider theme={theme}>\r\n      <App />\r\n    </MuiThemeProvider>\r\n  </Provider>\r\n);\r\n\r\nReactDOM.render(<Render />, document.getElementById('root'));\r\n"],"sourceRoot":""}